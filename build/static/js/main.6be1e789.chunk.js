(this["webpackJsonpanime-gan.js"]=this["webpackJsonpanime-gan.js"]||[]).push([[0],{26:function(e,t,a){e.exports=a(49)},31:function(e,t,a){},38:function(e,t){},39:function(e,t){},40:function(e,t){},41:function(e,t){},42:function(e,t){},43:function(e,t){},45:function(e,t,a){},49:function(e,t,a){"use strict";a.r(t);var n,r=a(1),o=a.n(r),s=a(18),l=a.n(s),c=(a(31),a(23)),i=a(7),u=a.n(i),m=a(9),d=a(19),p=a(20),g=a(25),f=a(24),h=a(51),E=a(52),b=a(22),v=a(53),y=a(54),w=a(55),x=a(6),k=a(8);window.tf=x,window.tfc=k,window.progress=0,window.bytesUsed=0,x.enableProdMode();var A=window.location.href+"model_full/model.json";function S(e,t){return x.tidy((function(){for(var a=0;a<4;a++){if(0!==t[a][0]||0!==t[a][1]){var n=[-1,-1,-1,-1];n[a]=t[a][0];var r=[0,0,0,0],o=e.slice(r,n);(n=[-1,-1,-1,-1])[a]=t[a][1],(r=[0,0,0,0])[a]=e.shape[a]-t[a][1];var s=e.slice(r,n);e=x.concat([o,e,s],a)}if(t[a][0]>1||t[a][1]>1)throw new Error("Only input with no more than length one in padding is supported. We have: "+JSON.stringify(t))}return e}))}window.mirrorPadFunc=S;var N=[.00023367749587460492,.054088046653978504,.1804816724673639,.18052037621199904,.2528568019649621,.37458444400475477,.39315031021211105,.39319017797911254,.4444196766347441,.5207431700988491,.550593651422125,.5542242372745627,.5605664132978859,.5806242652109398,.5927784050567816,.5962346785553008,.5981026434950807,.5989430676647844,.6435568450337933,.6676838282371483,.6684442258671517,.7463103400111626,.9019785470675509,.95],I=0,j=function(){var e=Object(m.a)(u.a.mark((function e(t){var a,r,o,s,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=.9*(performance.now()-n)/15463.61999999499,a=I>=N.length?.95:N[I],I+=1,window.progress=a,r=x.memory(),window.bytesUsed=r.numBytes,e.next=8,x.nextFrame();case 8:if("reflect"===t.attrs.mode){e.next=10;break}throw new Error("Only reflect mode is supported. Mode: "+t.attrs.mode);case 10:if(o=t.inputs[1],4!==t.inputs[0].shape.length){e.next=19;break}return e.next=14,o.array();case 14:return s=e.sent,l=t.inputs[0],e.abrupt("return",S(l,s));case 19:throw new Error("Only input of rank 4 is supported. We have: "+JSON.stringify(o.arraySync()));case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();k.registerOp("MirrorPad",j);var C=function(){var e=Object(m.a)(u.a.mark((function e(t,a,r,o){var s,l,c,i,m,d;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Generation start"),s=x.browser.fromPixels(r),console.log("Original image size:",s.shape),-1!==a?(c=(s.shape[0]>s.shape[1]?s.shape[0]:s.shape[1])/a,i=[Math.round(s.shape[0]/c),Math.round(s.shape[1]/c)],console.log("Scale to:",i),l=x.tidy((function(){return x.image.resizeBilinear(s,i).expandDims(0).div(255)})),s.dispose()):(l=x.tidy((function(){return s.expandDims(0).div(255)})),s.dispose()),n=performance.now(),e.next=7,t.executeAsync({test:l});case 7:m=e.sent,l.dispose(),d=performance.now(),console.log("Image Generated"),console.log("Took ".concat((d-n)/1e3," s to generate the image")),x.browser.toPixels(m.squeeze(0).add(1).div(2),o),m.dispose();case 14:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),O=function(){var e=Object(m.a)(u.a.mark((function e(t,a,n,r){var o,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a?x.env().set("WEBGL_FORCE_F16_TEXTURES",!0):x.env().set("WEBGL_FORCE_F16_TEXTURES",!1),o="s"===t?100:"m"===t?250:"l"===t?500:-1,s=performance.now(),e.next=5,k.loadGraphModel(A).then(function(){var e=Object(m.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Model Loaded"),a=performance.now(),console.log("Took ".concat((a-s)/1e3," s to load the model")),e.next=5,C(t,o,document.getElementById(n),document.getElementById(r));case 5:x.disposeVariables(),console.log(x.memory());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:window.progress=1;case 6:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),G=(a(44),a(45),"https://m14q2370xb.execute-api.us-east-1.amazonaws.com"),F=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).onUpload=function(e){var t=e.target,a=new FileReader;a.onload=function(){var e=a.result;n.setState({uploadedImageURL:e,uploaded:!0})},a.readAsDataURL(t.files[0])},n.generate=Object(m.a)(u.a.mark((function e(){var t,a,r,o,s,l,c,i,m,d,p;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===n.state.generationStatus){e.next=2;break}return e.abrupt("return");case 2:if(console.log(n.state),!1!==n.state.uploaded){e.next=6;break}return alert("Please upload an image."),e.abrupt("return");case 6:if("none"!==n.state.resize){e.next=9;break}return alert("Please select a resize method."),e.abrupt("return");case 9:return window.progress=0,window.bytesUsed=0,t=setInterval((function(){n.setState({generationProgress:100*window.progress,bytesUsed:window.bytesUsed}),1!==n.state.generationStatus&&clearInterval(t)}),500),n.setState({generationStatus:1,updateGenerationProgressInterval:t}),a=!1,e.prev=14,e.next=17,O(n.state.resize,n.state.fp16,"uploaded-image","output");case 17:a=!0,e.next=24;break;case 20:e.prev=20,e.t0=e.catch(14),alert("Error encountered while generating image: "+e.t0),n.setState({generationStatus:0});case 24:if(!a){e.next=62;break}return e.prev=25,r=n.state.uploadedImageURL.split(",")[1],o={base64_image:r,generated:!1},e.next=30,fetch(G+"/upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});case 30:return s=e.sent,e.next=33,s.json();case 33:return l=e.sent,console.log("API call 1 success: "+l),c=document.getElementById("output"),i=c.toDataURL("image/png").split(",")[1],o={base64_image:i,generated:!0},e.next=40,fetch(G+"/upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});case 40:return s=e.sent,e.next=43,s.json();case 43:if(l=e.sent,console.log("API call 2 success: "),!s.ok){e.next=53;break}console.log(l),m=l.key,d=m?m.replace("-generated.jpg",""):"",n.setState({uuid:d}),n.setState({generationStatus:2}),e.next=57;break;case 53:return e.next=55,s.json();case 55:p=e.sent,console.log(p.message);case 57:e.next=62;break;case 59:e.prev=59,e.t1=e.catch(25),console.log("Error while calling API:"+e.t1);case 62:case"end":return e.stop()}}),e,null,[[14,20],[25,59]])}))),n.onRatingChange=function(e){n.setState({rating:e.target.value})},n.onFeedbackChange=function(e){n.setState({feedback:e.target.value})},n.submitGeneratedImageFeedback=Object(m.a)(u.a.mark((function e(){var t,a,r,o,s,l,c,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state,a=t.rating,r=t.feedback,e.prev=1,o=n.state.uuid,s={uuid:o,rating:a,feedback:r},e.next=6,fetch(G+"/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});case 6:return l=e.sent,e.next=9,l.json();case 9:if(c=e.sent,console.log("API call feedback: "+c),!l.ok){e.next=15;break}n.setState({feedbackSubmitted:!0,rating:0,feedback:""}),e.next=19;break;case 15:return e.next=17,l.json();case 17:throw i=e.sent,new Error(i.message||"Failed to submit feedback");case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(1),alert("Error encountered while submitting feedback: "+e.t0);case 24:case"end":return e.stop()}}),e,null,[[1,21]])}))),n.componentWillUnmount=function(){-1!==n.state.updateGenerationProgressInterval&&clearInterval(n.state.updateGenerationProgressInterval)},n.state={uploadedImageURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",uploaded:!1,fp16:0,resize:"none",generationStatus:0,updateGenerationProgressInterval:-1,bytesUsed:0,rating:0,feedback:"",feedbackSubmitted:!1,uuid:""},n}return Object(p.a)(a,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"app"},o.a.createElement(h.a,{fluid:!0,style:{display:0===this.state.generationStatus?"block":"none"}},o.a.createElement(E.a,{className:"margin"},o.a.createElement(b.a,null),o.a.createElement(b.a,{xs:"12"},o.a.createElement("h1",{style:{marginBottom:"20px",textAlign:"center"}},"AnimeGAN.js: Photo Animation for Everyone ",o.a.createElement("a",{href:"https://github.com/TonyLianLong/AnimeGAN.js",style:{fontSize:"12px"}},"View Source Code"))),o.a.createElement(b.a,null)),o.a.createElement(E.a,{className:"margin"},o.a.createElement(b.a,null),o.a.createElement(b.a,{xs:"12",md:"8",lg:"6"},o.a.createElement(v.a,null,o.a.createElement(v.a.File,{accept:"image/*",label:this.state.uploaded?"Change the image":"Upload an image",onChange:this.onUpload,multiple:!1,custom:!0}))),o.a.createElement(b.a,null)),o.a.createElement(E.a,{className:"margin"},o.a.createElement(b.a,null),o.a.createElement(b.a,{xs:"12",md:"8",lg:"5",xl:"4",style:{textAlign:"center",margin:"20px"}},o.a.createElement("img",{id:"uploaded-image",alt:"",src:this.state.uploadedImageURL})),o.a.createElement(b.a,null)),o.a.createElement(E.a,{className:"margin"},o.a.createElement(b.a,null),o.a.createElement(b.a,{xs:"12",md:"8",lg:"6",style:{textAlign:"center"}},o.a.createElement(v.a,null,o.a.createElement(v.a.Group,{controlId:"resize"},o.a.createElement(v.a.Control,{defaultValue:"none",as:"select",onChange:function(t){return e.setState({resize:t.target.value})}},o.a.createElement("option",{value:"none",disabled:!0},"Select Generated Image Size"),o.a.createElement("option",{value:"s"},"Small (Fast)"),o.a.createElement("option",{value:"m"},"Medium"),o.a.createElement("option",{value:"l"},"Large (Slow)"),o.a.createElement("option",{value:"original"},"Do Not Resize (Likely to break if the image is too large)"))),o.a.createElement(v.a.Group,{controlId:"fp16"},o.a.createElement(v.a.Control,{as:"select",onChange:function(t){return e.setState({fp16:parseInt(t.target.value)})}},o.a.createElement("option",{value:"0"},"Force FP16 For Speed (Lower Quality): No"),o.a.createElement("option",{value:"1"},"Force FP16 For Speed (Lower Quality): Yes"))),o.a.createElement(y.a,{variant:"primary",onClick:this.generate},"Generate"))),o.a.createElement(b.a,null))),o.a.createElement("div",{className:"overlay",style:{display:1===this.state.generationStatus?"block":"none"}},o.a.createElement("div",{style:{marginTop:"calc( 50vh - 50px )",height:"100px",textAlign:"center"}},o.a.createElement(h.a,{fluid:!0},o.a.createElement(E.a,null,o.a.createElement(b.a,null),o.a.createElement(b.a,{xs:"12",md:"8",lg:"6",style:{textAlign:"center"}},o.a.createElement(w.a,{now:this.state.generationProgress,style:{margin:"10px"}}),o.a.createElement("p",null,"Generating image..."),o.a.createElement("p",null,"This may take 15 to 30 seconds depending on your device."),o.a.createElement("p",null,"Memory usage (MB): ",this.state.bytesUsed/1e6," ")),o.a.createElement(b.a,null))))),o.a.createElement("div",{className:"overlay",style:{display:2===this.state.generationStatus?"block":"none"}},o.a.createElement(h.a,{fluid:!0},o.a.createElement(E.a,{className:"margin"},o.a.createElement(b.a,null),o.a.createElement(b.a,{xs:"12",md:"8",lg:"5",xl:"4",style:{textAlign:"center",margin:"20px"}},o.a.createElement("canvas",{id:"output"})),o.a.createElement(b.a,null)),o.a.createElement("div",{className:"feedback-section mx-auto",style:{width:"15%",border:"1px solid #ccc",padding:"10px"}},this.state.feedbackSubmitted&&o.a.createElement("div",{className:"text-success mt-3"},"Feedback submitted successfully!"),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Rating:"),o.a.createElement("select",{value:this.state.rating,onChange:this.onRatingChange,className:"form-control"},Object(c.a)(Array(6).keys()).map((function(e){return o.a.createElement("option",{key:e,value:e},e)})))),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Feedback:"),o.a.createElement("textarea",{value:this.state.feedback,onChange:this.onFeedbackChange,className:"form-control"})),o.a.createElement("button",{onClick:this.submitGeneratedImageFeedback,className:"btn btn-primary"},"Submit Feedback")),o.a.createElement(E.a,{className:"margin"},o.a.createElement(b.a,null),o.a.createElement(b.a,{xs:"12",md:"12",lg:"12",xl:"10",style:{textAlign:"center",margin:"20px"}},o.a.createElement("p",null,"If you are on a mobile device, long press to save the image."),o.a.createElement("p",null,"If you are on a desktop device, right click to save the image."),o.a.createElement("p",null,"If it looks good, you could ",o.a.createElement("a",{href:"https://github.com/TonyLianLong/AnimeGAN.js"},"give AnimeGAN.js a star ",o.a.createElement("span",{role:"img","aria-label":"star"},"\ud83c\udf1f")," on Github"),"."),o.a.createElement("p",null,"AnimeGAN.js uses the trained model from AnimeGAN. If you are interested in how the TensorFlow version of AnimeGAN works, ",o.a.createElement("a",{href:"https://github.com/TachibanaYoshino/AnimeGAN"},"click here")),o.a.createElement(y.a,{variant:"primary",onClick:function(){return window.location.reload()}},"Restart")),o.a.createElement(b.a,null)))))}}]),a}(o.a.Component);l.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(F,null)),document.getElementById("root")),function(){var e=performance.now();k.loadGraphModel(A).then((function(t){console.log("Model Loaded");var a=performance.now();console.log("Took ".concat((a-e)/1e3," s to load the model")),t.dispose()}))}()}},[[26,1,2]]]);
//# sourceMappingURL=main.6be1e789.chunk.js.map