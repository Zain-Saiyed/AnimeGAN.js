{"version":3,"sources":["generate.js","config.js","App.js","index.js"],"names":["start","window","tf","tfc","progress","bytesUsed","MODEL_URL","location","href","mirrorPadFunc","input","pad_arr","i","slice_size","slice_begin","padding_left","slice","shape","padding_right","Error","JSON","stringify","progressesList","num_called","mirrorPad","node","a","performance","now","length","memoryInfo","numBytes","attrs","mode","pad_tensor","inputs","array","arraySync","generate","model","long_side_scale_size","img","output","console","log","img_tensor","fromPixels","scale_factor","scaled_size","Math","round","scaled_img_tensor","resizeBilinear","expandDims","div","dispose","executeAsync","generated","end","toPixels","squeeze","add","generateImage","resize","fp16","img_id","canvas_id","set","model_load_start","then","model_load_end","document","getElementById","API_URL","App","props","onUpload","e","target","reader","FileReader","onload","dataURL","result","setState","uploadedImageURL","uploaded","readAsDataURL","files","state","generationStatus","alert","updateGenerationProgressInterval","setInterval","generationProgress","clearInterval","success","originalImage","split","payload","base64_image","fetch","method","headers","body","response","json","outputCanvas","generatedImage","toDataURL","ok","key","uuid","replace","error","message","onRatingChange","event","rating","value","onFeedbackChange","feedback","submitGeneratedImageFeedback","feedbackPayload","feedbackSubmitted","errorResponse","componentWillUnmount","className","Container","fluid","style","this","Row","Col","xs","textAlign","md","lg","Form","File","accept","label","onChange","multiple","custom","xl","margin","id","alt","src","Group","controlId","Control","defaultValue","as","disabled","parseInt","Button","variant","onClick","ProgressBar","width","border","padding","Array","keys","map","role","aria-label","reload","React","Component","ReactDOM","render","StrictMode","preHeat"],"mappings":"8TAUIA,E,sKAPJC,OAAOC,GAAKA,EACZD,OAAOE,IAAMA,EACbF,OAAOG,SAAW,EAClBH,OAAOI,UAAY,EAEnBH,mBAIA,IAAMI,EAAYL,OAAOM,SAASC,KAAO,wBAEzC,SAASC,EAAcC,EAAOC,GAC1B,OAAOT,QAAQ,WACX,IAAK,IAAIU,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACxB,GAAsB,IAAlBD,EAAQC,GAAG,IAA8B,IAAlBD,EAAQC,GAAG,GAAU,CAC5C,IAAIC,EAAa,EAAE,GAAI,GAAI,GAAI,GAC/BA,EAAWD,GAAKD,EAAQC,GAAG,GAC3B,IAAIE,EAAc,CAAC,EAAG,EAAG,EAAG,GAExBC,EAAeL,EAAMM,MAAMF,EAAaD,IAE5CA,EAAa,EAAE,GAAI,GAAI,GAAI,IAChBD,GAAKD,EAAQC,GAAG,IAC3BE,EAAc,CAAC,EAAG,EAAG,EAAG,IACZF,GAAKF,EAAMO,MAAML,GAAKD,EAAQC,GAAG,GAE7C,IAAIM,EAAgBR,EAAMM,MAAMF,EAAaD,GAE7CH,EAAQR,SAAU,CAACa,EAAcL,EAAOQ,GAAgBN,GAG5D,GAAID,EAAQC,GAAG,GAAK,GAAKD,EAAQC,GAAG,GAAK,EACrC,MAAM,IAAIO,MAAM,6EAA+EC,KAAKC,UAAUV,IAGtH,OAAOD,KAKfT,OAAOQ,cAAgBA,EAEvB,IAAMa,EAAiB,CAAC,sBAAwB,oBAAsB,kBAAoB,mBAAqB,kBAAoB,mBAAqB,mBAAqB,mBAAqB,kBAAoB,kBAAoB,iBAAmB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,kBAAoB,KACzeC,EAAa,EAEXC,EAAS,uCAAG,WAAOC,GAAP,uBAAAC,EAAA,6DACVtB,EAAW,IAAOuB,YAAYC,MAAQ5B,GAAQ,kBAM9CI,EADAmB,GAAcD,EAAeO,OAClB,IAEAP,EAAeC,GAE9BA,GAAc,EAEdtB,OAAOG,SAAWA,EAEd0B,EAAa5B,WAEjBD,OAAOI,UAAYyB,EAAWC,SAjBhB,SAsBR7B,cAtBQ,UAwBU,YAApBuB,EAAKO,MAAMC,KAxBD,uBAyBJ,IAAId,MAAM,yCAA2CM,EAAKO,MAAMC,MAzB5D,WA2BVC,EAAaT,EAAKU,OAAO,GAEO,IAAhCV,EAAKU,OAAO,GAAGlB,MAAMY,OA7BX,kCA8BUK,EAAWE,QA9BrB,eA8BNzB,EA9BM,OA+BND,EAAQe,EAAKU,OAAO,GA/Bd,kBAgCH1B,EAAcC,EAAOC,IAhClB,cAkCJ,IAAIQ,MAAM,+CAAiDC,KAAKC,UAAUa,EAAWG,cAlCjF,4CAAH,sDAsCflC,aAAe,YAAaqB,GAE5B,IAAMc,EAAQ,uCAAG,WAAOC,EAAOC,EAAsBC,EAAKC,GAAzC,yBAAAhB,EAAA,6DACbiB,QAAQC,IAAI,oBACRC,EAAa3C,UAAW4C,WAAWL,GAEvCE,QAAQC,IAAI,uBAAwBC,EAAW5B,QACjB,IAA1BuB,GACIO,GAAgBF,EAAW5B,MAAM,GAAK4B,EAAW5B,MAAM,GAAK4B,EAAW5B,MAAM,GAAK4B,EAAW5B,MAAM,IAAMuB,EACzGQ,EAAc,CAACC,KAAKC,MAAML,EAAW5B,MAAM,GAAK8B,GAAeE,KAAKC,MAAML,EAAW5B,MAAM,GAAK8B,IACpGJ,QAAQC,IAAI,YAAaI,GACzBG,EAAoBjD,QAAQ,kBACxBA,QAASkD,eAAeP,EAAYG,GAAaK,WAAW,GAAGC,IAAI,QAEvET,EAAWU,YAEXJ,EAAoBjD,QAAQ,kBACxB2C,EAAWQ,WAAW,GAAGC,IAAI,QAEjCT,EAAWU,WAGfvD,EAAQ2B,YAAYC,MApBP,SAqBSW,EAAMiB,aAAa,CAAC,KAAQL,IArBrC,OAqBTM,EArBS,OAsBbN,EAAkBI,UACdG,EAAM/B,YAAYC,MACtBe,QAAQC,IAAI,mBACZD,QAAQC,IAAR,gBAAqBc,EAAM1D,GAAO,IAAlC,6BAEAE,UAAWyD,SAAUF,EAAUG,QAAQ,GAAGC,IAAI,GAAIP,IAAI,GAAIZ,GAE1De,EAAUF,UA7BG,4CAAH,4DA2CVO,EAAa,uCAAG,WAAOC,EAAQC,EAAMC,EAAQC,GAA7B,iBAAAxC,EAAA,6DACZsC,EAEA9D,QAASiE,IAAI,4BAA4B,GAEzCjE,QAASiE,IAAI,4BAA4B,GAMzC3B,EADW,MAAXuB,EACuB,IACL,MAAXA,EACgB,IACN,MAAXA,EACiB,KAEC,EAGxBK,EAAmBzC,YAAYC,MApBnB,SAqBVzB,iBAAmBG,GAAW+D,KAA9B,uCAAmC,WAAO9B,GAAP,eAAAb,EAAA,6DACrCiB,QAAQC,IAAI,gBACR0B,EAAiB3C,YAAYC,MACjCe,QAAQC,IAAR,gBAAqB0B,EAAiBF,GAAkB,IAAxD,yBAHqC,SAI/B9B,EAASC,EAAOC,EAAsB+B,SAASC,eAAeP,GAASM,SAASC,eAAeN,IAJhE,OAKrChE,qBACAyC,QAAQC,IAAI1C,YANyB,2CAAnC,uDArBU,OA6BhBD,OAAOG,SAAW,EA7BF,2CAAH,4DCnIJqE,G,YAAU,0DC8SRC,E,kDArSX,WAAYC,GAAQ,IAAD,8BACf,cAAMA,IAgBVC,SAAW,SAACC,GACR,IAAInE,EAAQmE,EAAEC,OACVC,EAAS,IAAIC,WACjBD,EAAOE,OAAS,WACZ,IAAIC,EAAUH,EAAOI,OACrB,EAAKC,SAAS,CACVC,iBAAkBH,EAClBI,UAAU,KAGlBP,EAAOQ,cAAc7E,EAAM8E,MAAM,KA3BlB,EA8BnBlD,SA9BmB,sBA8BR,gDAAAZ,EAAA,yDAC6B,IAAhC,EAAK+D,MAAMC,iBADR,oDAKP/C,QAAQC,IAAI,EAAK6C,QACW,IAAxB,EAAKA,MAAMH,SANR,uBAOHK,MAAM,2BAPH,6BAUmB,SAAtB,EAAKF,MAAM1B,OAVR,uBAWH4B,MAAM,kCAXH,iCAeP1F,OAAOG,SAAW,EAClBH,OAAOI,UAAY,EACfuF,EAAmCC,aAAY,WAC/C,EAAKT,SAAS,CACVU,mBAAsC,IAAlB7F,OAAOG,SAC3BC,UAAWJ,OAAOI,YAGc,IAAhC,EAAKoF,MAAMC,kBACXK,cAAcH,KAEnB,KAGH,EAAKR,SAAS,CACVM,iBAAkB,EAClBE,iCAAkCA,IAElCI,GAAU,EAjCP,oBAmCGlC,EAAc,EAAK2B,MAAM1B,OAAQ,EAAK0B,MAAMzB,KAAM,iBAAkB,UAnCvE,QAoCHgC,GAAU,EApCP,mDAsCHL,MAAM,mDACN,EAAKP,SAAS,CACVM,iBAAkB,IAxCnB,YA4CHM,EA5CG,kCA+COC,EAAgB,EAAKR,MAAMJ,iBAAiBa,MAAM,KAAK,GACzDC,EAAU,CAAEC,aAAcH,EAAgBxC,WAAW,GAhD1D,UAiDsB4C,MAAO5B,EAAQ,UAAW,CAC3C6B,OAAQ,OACRC,QAAS,CAAE,eAAgB,oBAC3BC,KAAMpF,KAAKC,UAAU8E,KApD1B,eAiDKM,EAjDL,iBAsDoBA,EAASC,OAtD7B,eAsDKvB,EAtDL,OAuDCxC,QAAQC,IAAI,uBAAuBuC,GAG7BwB,EAAepC,SAASC,eAAe,UACvCoC,EAAiBD,EAAaE,UAAU,aAAaX,MAAM,KAAK,GAClEC,EAAU,CAAEC,aAAcQ,EAAiBnD,WAAW,GA5D3D,UA6DsB4C,MAAO5B,EAAQ,UAAW,CACvC6B,OAAQ,OACRC,QAAS,CAAE,eAAgB,oBAC3BC,KAAMpF,KAAKC,UAAU8E,KAhE9B,eA6DKM,EA7DL,iBAkEgBA,EAASC,OAlEzB,WAkECvB,EAlED,OAmECxC,QAAQC,IAAI,yBAGR6D,EAASK,GAtEd,iBAuEKnE,QAAQC,IAAIuC,GAEN4B,EAAM5B,EAAM,IACZ6B,EAAOD,EAAMA,EAAIE,QAAQ,iBAAkB,IAAM,GAE3D,EAAK7B,SAAS,CAAE4B,KAAMA,IAClB,EAAK5B,SAAS,CACVM,iBAAkB,IA9E3B,yCAiFyBe,EAASC,OAjFlC,QAiFWQ,EAjFX,OAkFKvE,QAAQC,IAAIsE,EAAMC,SAlFvB,2DAqFCxE,QAAQC,IAAI,iCArFb,mEA9BQ,EAyHnBwE,eAAiB,SAACC,GACd,EAAKjC,SAAS,CACVkC,OAAQD,EAAMvC,OAAOyC,SA3HV,EA+HnBC,iBAAmB,SAACH,GAChB,EAAKjC,SAAS,CACVqC,SAAUJ,EAAMvC,OAAOyC,SAjIZ,EAqInBG,6BArImB,sBAqIY,0CAAAhG,EAAA,+DACE,EAAK+D,MAA1B6B,EADmB,EACnBA,OAAQG,EADW,EACXA,SADW,SAIhBT,EAAQ,EAAKvB,MAAbuB,KACDW,EAAkB,CACpBX,KAAMA,EACNM,OAAQA,EACRG,SAAUA,GARS,SAWApB,MAAM5B,EAAQ,YAAa,CAC9C6B,OAAQ,OACRC,QAAS,CAAE,eAAgB,oBAC3BC,KAAMpF,KAAKC,UAAUsG,KAdF,cAWjBlB,EAXiB,gBAgBAA,EAASC,OAhBT,UAgBfvB,EAhBe,OAiBnBxC,QAAQC,IAAI,sBAAsBuC,IAClCsB,EAASK,GAlBU,iBAoBnB,EAAK1B,SAAS,CACVwC,mBAAmB,EACnBN,OAAO,EACPG,SAAU,KAvBK,yCA2BShB,EAASC,OA3BlB,cA2BbmB,EA3Ba,OA4Bb,IAAI1G,MAAM0G,EAAcV,SAAW,6BA5BtB,0DA+BvBxB,MAAM,sDA/BiB,0DArIZ,EAwKnBmC,qBAAuB,YACkC,IAAjD,EAAKrC,MAAMG,kCACXG,cAAc,EAAKN,MAAMG,mCAxK7B,EAAKH,MAAQ,CACTJ,iBAAkB,qHAClBC,UAAU,EACVtB,KAAM,EACND,OAAQ,OACR2B,iBAAkB,EAClBE,kCAAmC,EACnCvF,UAAW,EACXiH,OAAQ,EACRG,SAAU,GACVG,mBAAmB,EACnBZ,KAAM,IAbK,E,qDA8KR,IAAD,OACN,OACI,yBAAKe,UAAU,OACX,kBAACC,EAAA,EAAD,CAAWC,OAAK,EAACC,MAAO,CAAC,QAA2C,IAAhCC,KAAK1C,MAAMC,iBAAyB,QAAU,SAC9E,kBAAC0C,EAAA,EAAD,CAAKL,UAAU,UACX,kBAACM,EAAA,EAAD,MACI,kBAACA,EAAA,EAAD,CAAKC,GAAG,MACJ,wBAAIJ,MAAO,CAAC,aAAgB,OAAQK,UAAW,WAA/C,6CAAoG,uBAAG/H,KAAK,8CAA8C0H,MAAO,CAAC,SAAY,SAA1E,sBAE5G,kBAACG,EAAA,EAAD,OAEJ,kBAACD,EAAA,EAAD,CAAKL,UAAU,UACX,kBAACM,EAAA,EAAD,MACA,kBAACA,EAAA,EAAD,CAAKC,GAAG,KAAKE,GAAG,IAAIC,GAAG,KACnB,kBAACC,EAAA,EAAD,KACI,kBAACA,EAAA,EAAKC,KAAN,CAAWC,OAAO,UAAUC,MAAQV,KAAK1C,MAAMH,SAAW,mBAAqB,kBAAoBwD,SAAUX,KAAKvD,SAAUmE,UAAU,EAAOC,QAAM,MAI3J,kBAACX,EAAA,EAAD,OAEJ,kBAACD,EAAA,EAAD,CAAKL,UAAU,UACX,kBAACM,EAAA,EAAD,MACA,kBAACA,EAAA,EAAD,CAAKC,GAAG,KAAKE,GAAG,IAAIC,GAAG,IAAIQ,GAAG,IAAIf,MAAO,CAACK,UAAW,SAAUW,OAAQ,SACnE,yBAAKC,GAAG,iBAAiBC,IAAI,GAAGC,IAAKlB,KAAK1C,MAAMJ,oBAEpD,kBAACgD,EAAA,EAAD,OAEJ,kBAACD,EAAA,EAAD,CAAKL,UAAU,UACX,kBAACM,EAAA,EAAD,MACA,kBAACA,EAAA,EAAD,CAAKC,GAAG,KAAKE,GAAG,IAAIC,GAAG,IAAIP,MAAO,CAACK,UAAW,WAC1C,kBAACG,EAAA,EAAD,KACI,kBAACA,EAAA,EAAKY,MAAN,CAAYC,UAAU,UAClB,kBAACb,EAAA,EAAKc,QAAN,CAAcC,aAAa,OAAOC,GAAG,SAASZ,SAAU,SAACjE,GAAD,OAAO,EAAKO,SAAS,CAACrB,OAAQc,EAAEC,OAAOyC,UAC3F,4BAAQA,MAAM,OAAOoC,UAAQ,GAA7B,+BACA,4BAAQpC,MAAM,KAAd,gBACA,4BAAQA,MAAM,KAAd,UACA,4BAAQA,MAAM,KAAd,gBACA,4BAAQA,MAAM,YAAd,+DAGR,kBAACmB,EAAA,EAAKY,MAAN,CAAYC,UAAU,QAClB,kBAACb,EAAA,EAAKc,QAAN,CAAcE,GAAG,SAASZ,SAAU,SAACjE,GAAD,OAAO,EAAKO,SAAS,CAACpB,KAAM4F,SAAS/E,EAAEC,OAAOyC,WAC9E,4BAAQA,MAAM,KAAd,4CACA,4BAAQA,MAAM,KAAd,+CAGR,kBAACsC,EAAA,EAAD,CAAQC,QAAQ,UAAUC,QAAS5B,KAAK7F,UAAxC,cAGR,kBAAC+F,EAAA,EAAD,QAIR,yBAAKN,UAAU,UAAUG,MAAO,CAAC,QAA2C,IAAhCC,KAAK1C,MAAMC,iBAAyB,QAAU,SAEtF,yBAAKwC,MAAO,CAAC,UAAY,sBAAuB,OAAU,QAAS,UAAa,WAC5E,kBAACF,EAAA,EAAD,CAAWC,OAAK,GACZ,kBAACG,EAAA,EAAD,KACI,kBAACC,EAAA,EAAD,MACA,kBAACA,EAAA,EAAD,CAAKC,GAAG,KAAKE,GAAG,IAAIC,GAAG,IAAIP,MAAO,CAACK,UAAW,WAC1C,kBAACyB,EAAA,EAAD,CAAapI,IAAKuG,KAAK1C,MAAMK,mBAAoBoC,MAAO,CAAC,OAAU,UACnE,kDACA,uFACA,iDAAuBC,KAAK1C,MAAMpF,UAAY,IAA9C,MAEJ,kBAACgI,EAAA,EAAD,UAOhB,yBAAKN,UAAU,UAAUG,MAAO,CAAC,QAA2C,IAAhCC,KAAK1C,MAAMC,iBAAyB,QAAU,SACtF,kBAACsC,EAAA,EAAD,CAAWC,OAAK,GACZ,kBAACG,EAAA,EAAD,CAAKL,UAAU,UACX,kBAACM,EAAA,EAAD,MACA,kBAACA,EAAA,EAAD,CAAKC,GAAG,KAAKE,GAAG,IAAIC,GAAG,IAAIQ,GAAG,IAAIf,MAAO,CAACK,UAAW,SAAUW,OAAQ,SACnE,4BAAQC,GAAG,YAEf,kBAACd,EAAA,EAAD,OAGJ,yBAAKN,UAAU,2BAA2BG,MAAO,CAAE+B,MAAO,MAAOC,OAAQ,iBAAkBC,QAAS,SAC/FhC,KAAK1C,MAAMmC,mBACR,yBAAKG,UAAU,qBAAf,oCAEJ,yBAAKA,UAAU,cACX,0CACA,4BAAQR,MAAOY,KAAK1C,MAAM6B,OAAQwB,SAAUX,KAAKf,eAAgBW,UAAU,gBACtE,YAAIqC,MAAM,GAAGC,QAAQC,KAAI,SAAC/C,GAAD,OACtB,4BAAQR,IAAKQ,EAAOA,MAAOA,GAAQA,QAI/C,yBAAKQ,UAAU,cACX,4CACA,8BAAUR,MAAOY,KAAK1C,MAAMgC,SAAUqB,SAAUX,KAAKX,iBAAkBO,UAAU,kBAErF,4BAAQgC,QAAS5B,KAAKT,6BAA8BK,UAAU,mBAA9D,oBAEJ,kBAACK,EAAA,EAAD,CAAKL,UAAU,UACX,kBAACM,EAAA,EAAD,MACA,kBAACA,EAAA,EAAD,CAAKC,GAAG,KAAKE,GAAG,KAAKC,GAAG,KAAKQ,GAAG,KAAKf,MAAO,CAACK,UAAW,SAAUW,OAAQ,SACtE,2FACA,6FACA,0DAA+B,uBAAG1I,KAAK,+CAAR,2BAA8E,0BAAM+J,KAAK,MAAMC,aAAW,QAA5B,gBAA9E,cAA/B,KACA,uJAA4H,uBAAGhK,KAAK,gDAAR,eAC5H,kBAACqJ,EAAA,EAAD,CAAQC,QAAQ,UAAUC,QAAS,kBAAM9J,OAAOM,SAASkK,WAAzD,YAEJ,kBAACpC,EAAA,EAAD,c,GA7RVqC,IAAMC,WCDxBC,IAASC,OACL,kBAAC,IAAMC,WAAP,KACI,kBAAC,EAAD,OAEJvG,SAASC,eAAe,SH6Gd,WAEV,IAAIJ,EAAmBzC,YAAYC,MACnCzB,iBAAmBG,GAAW+D,MAAK,SAAC9B,GAChCI,QAAQC,IAAI,gBACZ,IAAI0B,EAAiB3C,YAAYC,MACjCe,QAAQC,IAAR,gBAAqB0B,EAAiBF,GAAkB,IAAxD,yBACA7B,EAAMgB,aGjHdwH,K","file":"static/js/main.6be1e789.chunk.js","sourcesContent":["import * as tf from '@tensorflow/tfjs';\nimport * as tfc from '@tensorflow/tfjs-converter';\n\nwindow.tf = tf;\nwindow.tfc = tfc;\nwindow.progress = 0;\nwindow.bytesUsed = 0;\n\ntf.enableProdMode();\n\nlet start;\n\nconst MODEL_URL = window.location.href + 'model_full/model.json';\n\nfunction mirrorPadFunc(input, pad_arr) {\n    return tf.tidy(() => {\n        for (let i = 0; i < 4; i++) {\n            if (pad_arr[i][0] !== 0 || pad_arr[i][1] !== 0) {\n                let slice_size = [-1, -1, -1, -1];\n                slice_size[i] = pad_arr[i][0];\n                let slice_begin = [0, 0, 0, 0];\n\n                let padding_left = input.slice(slice_begin, slice_size);\n\n                slice_size = [-1, -1, -1, -1];\n                slice_size[i] = pad_arr[i][1];\n                slice_begin = [0, 0, 0, 0];\n                slice_begin[i] = input.shape[i] - pad_arr[i][1];\n\n                let padding_right = input.slice(slice_begin, slice_size);\n                \n                input = tf.concat([padding_left, input, padding_right], i);\n            }\n\n            if (pad_arr[i][0] > 1 || pad_arr[i][1] > 1) {\n                throw new Error(\"Only input with no more than length one in padding is supported. We have: \" + JSON.stringify(pad_arr));\n            }\n        }\n        return input;\n    });\n}\n\n// For debugging purpose:\nwindow.mirrorPadFunc = mirrorPadFunc;\n\nconst progressesList = [0.00023367749587460492, 0.054088046653978504, 0.1804816724673639, 0.18052037621199904, 0.2528568019649621, 0.37458444400475477, 0.39315031021211105, 0.39319017797911254, 0.4444196766347441, 0.5207431700988491, 0.550593651422125, 0.5542242372745627, 0.5605664132978859, 0.5806242652109398, 0.5927784050567816, 0.5962346785553008, 0.5981026434950807, 0.5989430676647844, 0.6435568450337933, 0.6676838282371483, 0.6684442258671517, 0.7463103400111626, 0.9019785470675509, 0.95];\nlet num_called = 0;\n\nconst mirrorPad = async (node) => {\n    let progress = 0.9 * (performance.now() - start)/(15463.61999999499);\n    \n    /* progressesList.push(progress);\n    console.log(progressesList); */\n\n    if (num_called >= progressesList.length) {\n        progress = 0.95;\n    } else {\n        progress = progressesList[num_called];\n    }\n    num_called += 1;\n\n    window.progress = progress;\n\n    let memoryInfo = tf.memory();\n    // console.log(\"Memory Info:\", memoryInfo);\n    window.bytesUsed = memoryInfo.numBytes;\n\n    // Use normal pad (not mirror pad):\n    // return tf.pad(node.inputs[0], node.inputs[1].arraySync(), 0);\n\n    await tf.nextFrame();\n\n    if (node.attrs.mode !== \"reflect\") {\n        throw new Error(\"Only reflect mode is supported. Mode: \" + node.attrs.mode);\n    }\n    let pad_tensor = node.inputs[1];\n    // node.inputs[1].print();\n    if (node.inputs[0].shape.length === 4) {\n        let pad_arr = await pad_tensor.array();\n        let input = node.inputs[0];\n        return mirrorPadFunc(input, pad_arr);\n    } else {\n        throw new Error(\"Only input of rank 4 is supported. We have: \" + JSON.stringify(pad_tensor.arraySync()));\n    }\n};\n\ntfc.registerOp('MirrorPad', mirrorPad);\n\nconst generate = async (model, long_side_scale_size, img, output) => {\n    console.log(\"Generation start\")\n    let img_tensor = tf.browser.fromPixels(img);\n    let scaled_img_tensor;\n    console.log(\"Original image size:\", img_tensor.shape);\n    if (long_side_scale_size !== -1) {\n        let scale_factor = (img_tensor.shape[0] > img_tensor.shape[1] ? img_tensor.shape[0] : img_tensor.shape[1]) / long_side_scale_size; // long side scaled size\n        let scaled_size = [Math.round(img_tensor.shape[0] / scale_factor), Math.round(img_tensor.shape[1] / scale_factor)];\n        console.log(\"Scale to:\", scaled_size);\n        scaled_img_tensor = tf.tidy(() => (\n            tf.image.resizeBilinear(img_tensor, scaled_size).expandDims(0).div(255)\n        )); // Batch size may be larger\n        img_tensor.dispose();\n    } else {\n        scaled_img_tensor = tf.tidy(() => (\n            img_tensor.expandDims(0).div(255)\n        )); // Batch size may be larger\n        img_tensor.dispose();\n    }\n    \n    start = performance.now();\n    let generated = await model.executeAsync({'test': scaled_img_tensor});\n    scaled_img_tensor.dispose();\n    let end = performance.now();\n    console.log(\"Image Generated\");\n    console.log(`Took ${(end - start)/1000} s to generate the image`);\n\n    tf.browser.toPixels((generated.squeeze(0).add(1)).div(2), output);\n    // console.log(generated.print());\n    generated.dispose();\n}\n\nlet preHeat = () => {\n    // Pre-heat\n    let model_load_start = performance.now();\n    tfc.loadGraphModel(MODEL_URL).then((model) => {\n        console.log(\"Model Loaded\");\n        let model_load_end = performance.now();\n        console.log(`Took ${(model_load_end - model_load_start)/1000} s to load the model`);\n        model.dispose();\n    });\n}\n\nlet generateImage = async (resize, fp16, img_id, canvas_id) => {\n    if (fp16) {\n        // tf.webgl.forceHalfFloat();\n        tf.env().set('WEBGL_FORCE_F16_TEXTURES', true);\n    } else {\n        tf.env().set('WEBGL_FORCE_F16_TEXTURES', false);\n    }\n\n    let long_side_scale_size;\n\n    if (resize === \"s\") {\n        long_side_scale_size = 100;\n    } else if (resize === \"m\") {\n        long_side_scale_size = 250;\n    }else if (resize === \"l\") {\n        long_side_scale_size = 500;\n    } else {\n        long_side_scale_size = -1;\n    }\n\n    let model_load_start = performance.now();\n    await tfc.loadGraphModel(MODEL_URL).then(async (model) => {\n        console.log(\"Model Loaded\");\n        let model_load_end = performance.now();\n        console.log(`Took ${(model_load_end - model_load_start)/1000} s to load the model`);\n        await generate(model, long_side_scale_size, document.getElementById(img_id), document.getElementById(canvas_id));\n        tf.disposeVariables();\n        console.log(tf.memory());\n    });\n    window.progress = 1.0;\n};\n\nexport {preHeat, generateImage};\n","export const API_URL = 'https://m14q2370xb.execute-api.us-east-1.amazonaws.com';\n\n","import React from 'react';\nimport { Button, Form, Container, Row, Col, ProgressBar } from 'react-bootstrap';\nimport { generateImage } from './generate.js';\n\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './App.css';\nimport { API_URL } from './config';\n\nclass App extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            uploadedImageURL: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=\",\n            uploaded: false,\n            fp16: 0,\n            resize: \"none\",\n            generationStatus: 0,\n            updateGenerationProgressInterval: -1,\n            bytesUsed: 0,\n            rating: 0, \n            feedback: '', \n            feedbackSubmitted: false,\n            uuid: ''\n        };\n    }\n\n    onUpload = (e) => {\n        var input = e.target;\n        var reader = new FileReader();\n        reader.onload = () => {\n            var dataURL = reader.result;\n            this.setState({\n                uploadedImageURL: dataURL,\n                uploaded: true\n            }); \n        };\n        reader.readAsDataURL(input.files[0]);\n    }\n\n    generate = async () => {\n        if (this.state.generationStatus !== 0) {\n            return;\n        }\n\n        console.log(this.state);\n        if (this.state.uploaded === false) {\n            alert(\"Please upload an image.\");\n            return;\n        }\n        if (this.state.resize === \"none\") {\n            alert(\"Please select a resize method.\");\n            return;\n        }\n        \n        window.progress = 0;\n        window.bytesUsed = 0;\n        let updateGenerationProgressInterval = setInterval(() => {\n            this.setState({\n                generationProgress: window.progress * 100,\n                bytesUsed: window.bytesUsed\n            });\n\n            if (this.state.generationStatus !== 1) {\n                clearInterval(updateGenerationProgressInterval);\n            }\n        }, 500);\n\n\n        this.setState({\n            generationStatus: 1,\n            updateGenerationProgressInterval: updateGenerationProgressInterval\n        });\n        let success = false;\n        try {\n            await generateImage(this.state.resize, this.state.fp16, \"uploaded-image\", \"output\");\n            success = true;\n        } catch (error) {\n            alert(\"Error encountered while generating image: \" + error);\n            this.setState({\n                generationStatus: 0\n            });\n        }\n\n        if (success) {\n            try {\n            // Upload orginal image\n                const originalImage = this.state.uploadedImageURL.split(',')[1];\n                var payload = { base64_image: originalImage , generated: false};\n                var response = await fetch( API_URL+'/upload', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify(payload)\n                });\n                var result = await response.json();\n                console.log('API call 1 success: '+result);\n\n                // Upload generated image\n                const outputCanvas = document.getElementById('output');\n                const generatedImage = outputCanvas.toDataURL('image/png').split(',')[1];\n                    payload = { base64_image: generatedImage , generated: true};\n                    response = await fetch( API_URL+'/upload', {\n                        method: 'POST',\n                        headers: { 'Content-Type': 'application/json' },\n                        body: JSON.stringify(payload)\n                    });\n                result = await response.json();\n                console.log('API call 2 success: ');\n                \n                // API call successful\n                if (response.ok) {\n                    console.log(result);\n    \n                    const key = result['key'];\n                    const uuid = key ? key.replace('-generated.jpg', '') : '';\n                \n                this.setState({ uuid: uuid });\n                    this.setState({\n                        generationStatus: 2,\n                    });\n                } else {\n                    const error = await response.json();\n                    console.log(error.message);\n                }\n            } catch (error) {\n                console.log(\"Error while calling API:\" + error);\n            }\n        }\n        \n    }\n\n    onRatingChange = (event) => {\n        this.setState({\n            rating: event.target.value,\n        });\n    }\n\n    onFeedbackChange = (event) => {\n        this.setState({\n            feedback: event.target.value,\n        });\n    }\n\n    submitGeneratedImageFeedback = async () => {\n        const { rating, feedback } = this.state;\n\n        try {\n            const {uuid} = this.state;\n            const feedbackPayload = {\n                uuid: uuid,\n                rating: rating,\n                feedback: feedback,\n            };\n\n            const response = await fetch(API_URL+\"/feedback\", {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify(feedbackPayload),\n            });\n                var result = await response.json();\n                console.log('API call feedback: '+result);\n            if (response.ok) {\n                // Feedback submitted successfully\n                this.setState({\n                    feedbackSubmitted: true,\n                    rating:0,\n                    feedback: ''\n                });\n\n            } else {\n                const errorResponse = await response.json();\n                throw new Error(errorResponse.message || 'Failed to submit feedback');\n            }\n        } catch (error) {\n            alert(\"Error encountered while submitting feedback: \" + error);\n        }\n    }\n    \n    componentWillUnmount = () => {\n        if (this.state.updateGenerationProgressInterval !== -1) {\n            clearInterval(this.state.updateGenerationProgressInterval);\n        }\n    }\n    \n    render () {\n        return (\n            <div className=\"app\">\n                <Container fluid style={{\"display\": this.state.generationStatus === 0 ? \"block\" : \"none\"}}>\n                    <Row className=\"margin\">\n                        <Col/>\n                            <Col xs=\"12\">\n                                <h1 style={{\"marginBottom\": \"20px\", textAlign: \"center\"}}>AnimeGAN.js: Photo Animation for Everyone <a href=\"https://github.com/TonyLianLong/AnimeGAN.js\" style={{\"fontSize\": \"12px\"}}>View Source Code</a></h1>\n                            </Col>\n                        <Col/>\n                    </Row>\n                    <Row className=\"margin\">\n                        <Col/>\n                        <Col xs=\"12\" md=\"8\" lg=\"6\">\n                            <Form>\n                                <Form.File accept=\"image/*\" label={(this.state.uploaded ? \"Change the image\" : \"Upload an image\")} onChange={this.onUpload} multiple={false} custom />\n                            </Form>\n                            \n                        </Col>\n                        <Col/>\n                    </Row>\n                    <Row className=\"margin\">\n                        <Col/>\n                        <Col xs=\"12\" md=\"8\" lg=\"5\" xl=\"4\" style={{textAlign: \"center\", margin: \"20px\"}}>\n                            <img id=\"uploaded-image\" alt=\"\" src={this.state.uploadedImageURL} />\n                        </Col>\n                        <Col/>\n                    </Row>\n                    <Row className=\"margin\">\n                        <Col/>\n                        <Col xs=\"12\" md=\"8\" lg=\"6\" style={{textAlign: \"center\"}}>\n                            <Form>\n                                <Form.Group controlId=\"resize\">\n                                    <Form.Control defaultValue=\"none\" as=\"select\" onChange={(e) => this.setState({resize: e.target.value})}>\n                                        <option value=\"none\" disabled>Select Generated Image Size</option>\n                                        <option value=\"s\">Small (Fast)</option>\n                                        <option value=\"m\">Medium</option>\n                                        <option value=\"l\">Large (Slow)</option>\n                                        <option value=\"original\">Do Not Resize (Likely to break if the image is too large)</option>\n                                    </Form.Control>\n                                </Form.Group>\n                                <Form.Group controlId=\"fp16\">\n                                    <Form.Control as=\"select\" onChange={(e) => this.setState({fp16: parseInt(e.target.value)})}>\n                                        <option value=\"0\">Force FP16 For Speed (Lower Quality): No</option>\n                                        <option value=\"1\">Force FP16 For Speed (Lower Quality): Yes</option>\n                                    </Form.Control>\n                                </Form.Group>\n                                <Button variant=\"primary\" onClick={this.generate}>Generate</Button>\n                            </Form>\n                        </Col>\n                        <Col/>\n                    </Row>\n                </Container>\n\n                <div className=\"overlay\" style={{\"display\": this.state.generationStatus === 1 ? \"block\" : \"none\"}}>\n                \n                    <div style={{\"marginTop\":\"calc( 50vh - 50px )\", \"height\": \"100px\", \"textAlign\": \"center\"}}>\n                        <Container fluid>\n                            <Row>\n                                <Col/>\n                                <Col xs=\"12\" md=\"8\" lg=\"6\" style={{textAlign: \"center\"}}>\n                                    <ProgressBar now={this.state.generationProgress} style={{\"margin\": \"10px\"}} />\n                                    <p>Generating image...</p>\n                                    <p>This may take 15 to 30 seconds depending on your device.</p>\n                                    <p>Memory usage (MB): {this.state.bytesUsed / 1000000} </p>\n                                </Col>\n                                <Col/>\n                            </Row>\n                        </Container>\n                    </div>\n                    \n                </div>\n\n                <div className=\"overlay\" style={{\"display\": this.state.generationStatus === 2 ? \"block\" : \"none\"}}>\n                    <Container fluid>\n                        <Row className=\"margin\">\n                            <Col/>\n                            <Col xs=\"12\" md=\"8\" lg=\"5\" xl=\"4\" style={{textAlign: \"center\", margin: \"20px\"}}>\n                                <canvas id=\"output\"></canvas>\n                            </Col>\n                            <Col/>\n                        </Row>\n                        \n                        <div className=\"feedback-section mx-auto\" style={{ width: '15%', border: '1px solid #ccc', padding: '10px' }}>\n                            {this.state.feedbackSubmitted && (\n                                <div className=\"text-success mt-3\">Feedback submitted successfully!</div>\n                            )}\n                            <div className=\"form-group\">\n                                <label>Rating:</label>\n                                <select value={this.state.rating} onChange={this.onRatingChange} className=\"form-control\">\n                                    {[...Array(6).keys()].map((value) => (\n                                        <option key={value} value={value}>{value}</option>\n                                    ))}\n                                </select>\n                            </div>\n                            <div className=\"form-group\">\n                                <label>Feedback:</label>\n                                <textarea value={this.state.feedback} onChange={this.onFeedbackChange} className=\"form-control\" />\n                            </div>\n                            <button onClick={this.submitGeneratedImageFeedback} className=\"btn btn-primary\">Submit Feedback</button>\n                        </div>\n                        <Row className=\"margin\">\n                            <Col/>\n                            <Col xs=\"12\" md=\"12\" lg=\"12\" xl=\"10\" style={{textAlign: \"center\", margin: \"20px\"}}>\n                                <p>If you are on a mobile device, long press to save the image.</p>\n                                <p>If you are on a desktop device, right click to save the image.</p>\n                                <p>If it looks good, you could <a href=\"https://github.com/TonyLianLong/AnimeGAN.js\">give AnimeGAN.js a star <span role=\"img\" aria-label=\"star\">ðŸŒŸ</span> on Github</a>.</p>\n                                <p>AnimeGAN.js uses the trained model from AnimeGAN. If you are interested in how the TensorFlow version of AnimeGAN works, <a href=\"https://github.com/TachibanaYoshino/AnimeGAN\">click here</a></p>\n                                <Button variant=\"primary\" onClick={() => window.location.reload()}>Restart</Button>\n                            </Col>\n                            <Col/>\n                        </Row>\n                    </Container>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default App;\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nimport { preHeat } from './generate.js';\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById('root')\n);\n\npreHeat();\n"],"sourceRoot":""}